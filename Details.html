<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>User Details</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .card { border: 1px solid #ccc; padding: 20px; border-radius: 8px; width: 300px; }
    .card h2 { margin-top: 0; }
    .info { margin-bottom: 10px; }
    .label { font-weight: bold; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Your Account</h2>
    <div class="info"><span class="label">Email:</span> <span id="email"></span></div>
    <div class="info"><span class="label">Date Created:</span> <span id="dateCreated"></span></div>
    <div class="info"><span class="label">Last Accessed:</span> <span id="lastAccessed"></span></div>
  </div>

  <script>
    async function loadUserDetails() {
        try {
            const response = await fetch("http://127.0.0.1:5000/user-details", {
                method: "GET",
                headers: { "Content-Type": "application/json" },
                credentials: "include"  // <-- this includes the session cookie
            });

            if (!response.ok) throw new Error("Failed to fetch details");
            const data = await response.json();

            document.getElementById("email").textContent = data.email;
            document.getElementById("dateCreated").textContent = data.date_created;
            document.getElementById("lastAccessed").textContent = data.last_accessed || "Never";
        } catch (err) {
            alert("Error loading user details: " + err.message);
        }
    }

    window.addEventListener("DOMContentLoaded", loadUserDetails);
    loadUserDetails();
  </script>
</body>
</html>
